<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="index, follow" />

   <title>Профиль — ModelConnect Miami</title>
  <meta name="description" content=" Профиль модели, фотографа или стилиста в Майами">
    <!-- Open Graph -->
  <meta property="og:title" content="Профиль — ModelConnect Miami">
  <meta property="og:site_name" content="ModelConnect Miami" />
  <meta property="og:locale" content="ru_RU" />
  <meta property="og:description" content=" Профиль модели, фотографа или стилиста в Майами">
  <meta property="og:image" content="https://models-connect.netlify.app/img/og-image-main.webp">
  <meta property="og:url" content="https://models-connect.netlify.app/profiles">
  <meta property="og:type" content="website">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Профиль — ModelConnect Miami">
  <meta name="twitter:description" content=" Профиль модели, фотографа или стилиста в Майами">
  <meta name="twitter:image" content="https://models-connect.netlify.app/img/og-image-main.webp">

  <!-- Canonical -->
  <link rel="canonical" href="https://models-connect.netlify.app/profiles/profiles/">

  <!-- Favicon -->
  <link rel="icon" type="image/x-icon" href="https://models-connect.netlify.app/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="https://models-connect.netlify.app/img/apple-touch-icon.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="https://models-connect.netlify.app/img/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="16x16" href="https://models-connect.netlify.app/img/favicon-16x16.png" />
  <link rel="manifest" href="https://models-connect.netlify.app/img/site.webmanifest" />
  <link rel="stylesheet" href="https://models-connect.netlify.app/css/style.css">

  <!-- Schema.org JSON-LD -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "CollectionPage",
    
      "name": "Профиль — ModelConnect Miami",
      "description": " Профиль модели, фотографа или стилиста в Майами",
      "url": "https://models-connect.netlify.app/profiles/",
      "mainEntity": {
        "@type": "ItemList",
        "itemListElement": [
          
          {
            "@type": "ListItem",
            "position": 1,
            "item": {
              "@type": "Person",
              "name": "Ivan",
              "jobTitle": "Фотограф",
              "address": { "@type": "PostalAddress", "addressLocality": "Халландейл" },
              "image": "https://res.cloudinary.com/dimallvw3/image/upload/v1757334343/ca1h3mnfjw2vr8c4v2rq.jpg/img/placeholder.png",
              "url": "https://models-connect.netlify.app/profiles/af25b537-8bf5-46c5-85e2-ef50e7c74b41/"
            }
          },
          
          {
            "@type": "ListItem",
            "position": 2,
            "item": {
              "@type": "Person",
              "name": "John",
              "jobTitle": "Стилист",
              "address": { "@type": "PostalAddress", "addressLocality": "Майами-Бич" },
              "image": "https://res.cloudinary.com/dimallvw3/image/upload/v1757334399/mh6ejrpmv7xdm4i2ueae.jpg/img/placeholder.png",
              "url": "https://models-connect.netlify.app/profiles/83455fd6-193d-4b96-9e24-ed9160cab722/"
            }
          },
          
          {
            "@type": "ListItem",
            "position": 3,
            "item": {
              "@type": "Person",
              "name": "Kate",
              "jobTitle": "Модель",
              "address": { "@type": "PostalAddress", "addressLocality": "Корал-Гейблс" },
              "image": "https://res.cloudinary.com/dimallvw3/image/upload/v1757334441/cbjxr8libhlfmdthwekt.jpg/img/placeholder.png",
              "url": "https://models-connect.netlify.app/profiles/a411a3c2-d0db-420d-8a2e-778d95724200/"
            }
          },
          
          {
            "@type": "ListItem",
            "position": 4,
            "item": {
              "@type": "Person",
              "name": "Maria",
              "jobTitle": "Стилист",
              "address": { "@type": "PostalAddress", "addressLocality": "Халландейл" },
              "image": "https://res.cloudinary.com/dimallvw3/image/upload/v1757334488/szmq04q6ze5lrgaudkpr.jpg/img/placeholder.png",
              "url": "https://models-connect.netlify.app/profiles/53345958-12d5-492d-b15a-e4d0fc406c72/"
            }
          },
          
          {
            "@type": "ListItem",
            "position": 5,
            "item": {
              "@type": "Person",
              "name": "Nika",
              "jobTitle": "Модель",
              "address": { "@type": "PostalAddress", "addressLocality": "Майами-Бич" },
              "image": "https://res.cloudinary.com/dimallvw3/image/upload/v1757334629/idprxxfkwdmbsqw6mlqt.jpg/img/placeholder.png",
              "url": "https://models-connect.netlify.app/profiles/e5720766-b43c-4a2d-941d-2b6826a811d8/"
            }
          },
          
          {
            "@type": "ListItem",
            "position": 6,
            "item": {
              "@type": "Person",
              "name": "Tim",
              "jobTitle": "Фотограф",
              "address": { "@type": "PostalAddress", "addressLocality": "Корал-Гейблс" },
              "image": "https://res.cloudinary.com/dimallvw3/image/upload/v1757334672/agvnwemqynntxfc5ku5e.jpg/img/placeholder.png",
              "url": "https://models-connect.netlify.app/profiles/b4fe21c6-ee77-4ed8-a36b-5ed1453024d6/"
            }
          },
          
          {
            "@type": "ListItem",
            "position": 7,
            "item": {
              "@type": "Person",
              "name": "Anna",
              "jobTitle": "Модель",
              "address": { "@type": "PostalAddress", "addressLocality": "Халландейл" },
              "image": "https://res.cloudinary.com/dimallvw3/image/upload/v1757342206/pho5f1nncqprm4faucjc.jpg/img/placeholder.png",
              "url": "https://models-connect.netlify.app/profiles/50ba7c00-1993-4e21-9eef-b0474cc920a0/"
            }
          },
          
          {
            "@type": "ListItem",
            "position": 8,
            "item": {
              "@type": "Person",
              "name": "Test",
              "jobTitle": "Стилист",
              "address": { "@type": "PostalAddress", "addressLocality": "Корал-Гейблс" },
              "image": "https://res.cloudinary.com/dimallvw3/image/upload/v1757344642/l6zvuzteyvpmxtdmihly.jpg/img/placeholder.png",
              "url": "https://models-connect.netlify.app/profiles/a2e0472e-8848-477d-8be7-086c972fe368/"
            }
          }
          
        ]
      }
    
  }
  </script>

</head>
<body>

  <nav>
    <ul class="nav-list">
      <li><a href="/">Главная</a></li>
      <li><a href="/region/">Регионы</a></li>
      <li><a href="/category/">Категории</a></li>
      <li><a href="/add-profile/">Добавить профиль</a></li>
    </ul>
  </nav>

  <main>
    <div class="profile-page">
  <nav class="breadcrumbs">
    <a href="/">Главная</a> ›
    <a href="/profiles/">Профили</a> ›
    <span id="profile-name">Загрузка...</span>
  </nav>

  <div id="profile-container">
    <p>Загрузка профиля...</p>
  </div>
</div>

<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

(async () => {
  const container = document.getElementById("profile-container");
  const profileNameSpan = document.getElementById("profile-name");

  const SUPABASE_URL = "https://zftnzsbflzfhfyfnyqza.supabase.co";
  const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpmdG56c2JmbHpmaGZ5Zm55cXphIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTcwODQyMjQsImV4cCI6MjA3MjY2MDIyNH0.ZiNtVmNKFPsW7NPngNvRrDsRFwcPQw0aE6m8FwmCvZg";
  if (!SUPABASE_URL || !SUPABASE_ANON_KEY) {
    container.innerHTML = "<p>Ошибка: конфигурация Supabase не задана</p>";
    console.error("SUPABASE_URL or SUPABASE_ANON_KEY is missing");
    return;
  }

  const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const pathSegments = window.location.pathname.split("/").filter(Boolean);
  let id = null;
  if (pathSegments[pathSegments.length - 2] === "profiles") {
    const slug = pathSegments[pathSegments.length - 1];
    id = slug.split("-").pop(); // Предполагается формат name-uuid
  }

  const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;
  if (!id || !uuidRegex.test(id)) {
    container.innerHTML = "<p>Некорректный ID профиля</p>";
    profileNameSpan.textContent = "Ошибка";
    console.error("Invalid or missing profile ID:", id);
    return;
  }

  try {
    const { data, error } = await supabase
      .from("profiles")
      .select("*")
      .eq("id", id)
      .single();

    if (error || !data) {
      container.innerHTML = "<p>Профиль не найден</p>";
      profileNameSpan.textContent = "Не найден";
      console.error("Profile not found or error:", error?.message);
      return;
    }

    // Обновление title и SEO
    document.title = `${data.name || "Профиль"} — ${data.category || "Категория"} | ModelConnect Miami`;
    profileNameSpan.textContent = data.name || "Без имени";

    // Генерация HTML для профиля
    container.innerHTML = `
      <h1>${data.name || "Без имени"}</h1>
      <div style="display: flex; justify-content: space-around; flex-wrap: wrap;">
        <img src="${data.image_url || "/img/placeholder.png"}" alt="${data.name || "Фото профиля"}" loading="lazy" width="400" height="auto" style="max-width: 100%;">
        <div class="profile-card__description" style="max-width: 600px;">
          <p><strong>Категория:</strong> ${data.category || "Не указана"}</p>
          <p><strong>Город:</strong> ${data.city || "Не указан"}</p>
          ${data.age ? `<p><strong>Возраст:</strong> ${data.age}</p>` : ""}
          ${data.email ? `<p><strong>Email:</strong> <a href="mailto:${data.email}" rel="nofollow">${data.email}</a></p>` : ""}
          ${data.phone ? `<p><strong>Телефон:</strong> <a href="tel:${data.phone}" rel="nofollow">${data.phone}</a></p>` : ""}
          ${data.description ? `<p><strong>Описание:</strong> ${data.description}</p>` : ""}
        </div>
      </div>
      <a href="/">← Вернуться на главную</a>
    `;

    // Динамическое добавление JSON-LD
    const jsonLd = {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": data.name || "Профессионал",
      "description": data.description ? data.description.slice(0, 200) : "Профиль профессионала в fashion-индустрии Майами",
      "image": "https://models-connect.netlify.app" + (data.image_url || "/img/placeholder.png"),
      "jobTitle": data.category || "Специалист",
      "address": {
        "@type": "PostalAddress",
        "addressLocality": data.city || "Майами",
        "addressCountry": "US"
      },
      "email": data.email || "",
      "telephone": data.phone || "",
      "birthDate": data.age ? new Date(new Date().getFullYear() - data.age, 0, 1).toISOString().split("T")[0] : "",
      "url": "https://models-connect.netlify.app/profiles/" + (data.name ? data.name.toLowerCase().replace(/\s+/g, "-") + "-" + data.id.slice(0, 8) : data.id.slice(0, 8))
    };
    const script = document.createElement("script");
    script.type = "application/ld+json";
    script.textContent = JSON.stringify(jsonLd);
    document.head.appendChild(script);
  } catch (err) {
    container.innerHTML = `<p>Ошибка загрузки профиля: ${err.message}</p>`;
    profileNameSpan.textContent = "Ошибка";
    console.error("Error loading profile:", err.message);
  }
})();
</script>
  </main>

  <footer class="site-footer">
    <p>© 2025 ModelConnect Miami</p>
  </footer>

</body>
</html>
