---
layout: base
title: "Профиль"
seo_title: "Профиль — ModelConnect Miami"
seo_description: "Профиль модели, фотографа или стилиста в Майами"
seo_og_image: "/profiles/img/og-image-main.webp"
seo_og_url: "https://models-connect.netlify.app/profiles"
seo_og_type: website
seo_twitter_card: summary_large_image
seo_twitter_image: "/profiles/img/og-image-main.webp"
seo_canonical: "https://models-connect.netlify.app/profiles"
---
<div id="profile-container">
  <p>Загрузка профиля...</p>
</div>

<script type="module">
import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm";

(async () => {
  const container = document.getElementById("profile-container");

  const SUPABASE_URL = "{{ env.SUPABASE_URL }}";
  const SUPABASE_ANON_KEY = "{{ env.SUPABASE_ANON_KEY }}"; // безопасно для фронтенда
  if (!SUPABASE_URL || !SUPABASE_ANON_KEY) {
    container.innerHTML = "<p>Ошибка: ключи Supabase не заданы</p>";
    return;
  }

  const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

   let id = null;

  const pathSegments = window.location.pathname.split("/").filter(Boolean);
  if (pathSegments[pathSegments.length - 2] === "profiles") {
    id = pathSegments[pathSegments.length - 1];
  }

  const queryParams = new URLSearchParams(window.location.search);
  if (!id) id = queryParams.get("id");

  if (!id) {
    container.innerHTML = "<p>ID профиля не указан</p>";
    return;
  }

  try {
    const { data, error } = await supabase
      .from("profiles")
      .select("*")
      .eq("id", id)
      .single();

    if (error || !data) {
      container.innerHTML = "<p>Профиль не найден</p>";
      return;
    }

    document.title = `${data.name} — ${data.category}`;

    container.innerHTML = `
      <h1>${data.name}</h1>
      <p>${data.city || ""}, ${data.category || ""}</p>
      <img src="${data.image_url || "/img/placeholder.png"}" alt="${data.name}" style="max-width:400px;"/>
      <p>${data.description || ""}</p>
      <a href="/">← Вернуться на главную</a>
    `;
  } catch (err) {
    container.innerHTML = `<p>Ошибка загрузки профиля: ${err.message}</p>`;
  }
})();
</script>
